import{u as B,r as n,b as T,j as t}from"./vendor-BBDGfIfP.js";import{I as x}from"./input-error-DzlB5Qkt.js";import{L as b}from"./loading-button-BLSSbYXc.js";import{B as H}from"./button-BxbUMaK9.js";import{D as O,a as A,b as P,c as Q,d as U}from"./dialog-Ao4xhLhR.js";import{I as S}from"./input-Dldj9DiJ.js";import{L as f}from"./label-DUVUvbLf.js";import{S as V,a as R,b as z,c as G,d as J}from"./select-CMFY0w3t.js";import{o as K}from"./inertia-SZXqLvQm.js";import{k as W}from"./richtor-QjVY_KZS.js";import X from"./fill-blank-form-DtgybQ1l.js";import Y from"./listening-form-Tocc3Nud.js";import Z from"./matching-form-CnX0ecbh.js";import $ from"./multiple-choice-form-Cg3e5fUR.js";import q from"./ordering-form-Bz9HqlF6.js";import ee from"./short-answer-form-n1aRFOSs.js";import"./utils-fgVZ67ei.js";import"./index-BSu11NtU.js";import"./chunked-uploader-input-BS9NXBbE.js";import"./index-G4n3qM_p.js";import"./radio-group-CBkhOvCv.js";import"./textarea-ovCXlSTO.js";import"./checkbox-DFVJwr6m.js";const te=[{value:"multiple_choice",label:"Multiple Choice"},{value:"multiple_select",label:"Multiple Select"},{value:"matching",label:"Matching"},{value:"fill_blank",label:"Fill in the Blank"},{value:"ordering",label:"Ordering"},{value:"short_answer",label:"Short Answer"},{value:"listening",label:"Listening"}],Ce=({exam:F,question:l,handler:k})=>{const y=B().props,{translate:C}=y,{dashboard:e}=C||{},[g,m]=n.useState(!1),[r,a]=n.useState(!1),[D,j]=n.useState(!1),[d,p]=n.useState(!1),I={exam_id:F.id,title:(l==null?void 0:l.title)||"",description:(l==null?void 0:l.description)||"",marks:(l==null?void 0:l.marks)||1,options:(l==null?void 0:l.options)||{},question_options:((l==null?void 0:l.question_options)||[]).map(s=>({id:s.id?Number(s.id):void 0,option_text:s.option_text,is_correct:s.is_correct,sort:s.sort})),question_type:(l==null?void 0:l.question_type)||"multiple_choice",exam_question_id:l!=null&&l.id?Number(l.id):null},{data:i,setData:o,post:M,put:w,errors:c,processing:_,reset:h,clearErrors:E}=T(I),L=s=>{var u;if(s.preventDefault(),i.question_type==="listening"&&((u=i.options)==null?void 0:u.audio_source)==="upload"&&(!l||D)&&!d){a(!0);return}v()},v=()=>{E(),l?w(route("exam-questions.update",l.id),{preserveScroll:!0,onSuccess:()=>{m(!1),h(),a(!1),p(!1)}}):M(route("exam-questions.store"),{preserveScroll:!0,onSuccess:()=>{m(!1),h(),a(!1),p(!1)}})};n.useEffect(()=>{d&&r&&v()},[d,r]),n.useEffect(()=>{g||(a(!1),j(!1),p(!1))},[g]);const N=()=>{const s={data:i,setData:o,errors:c};switch(i.question_type){case"multiple_choice":case"multiple_select":return t.jsx($,{...s,isMultipleSelect:i.question_type==="multiple_select"});case"matching":return t.jsx(Z,{...s});case"fill_blank":return t.jsx(X,{...s});case"ordering":return t.jsx(q,{...s});case"short_answer":return t.jsx(ee,{...s});case"listening":return t.jsx(Y,{...s,isSubmit:r,setIsSubmit:a,setIsFileSelected:j,setIsFileUploaded:p});default:return null}};return t.jsxs(O,{open:g,onOpenChange:m,children:[t.jsx(A,{children:k}),t.jsxs(P,{className:"max-h-[90vh] max-w-4xl overflow-y-auto",children:[t.jsx(Q,{children:t.jsx(U,{children:l?(e==null?void 0:e.edit_question)||"تعديل السؤال":(e==null?void 0:e.create_question)||"إنشاء سؤال"})}),t.jsxs("form",{onSubmit:L,className:"space-y-6",children:[t.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[t.jsxs("div",{children:[t.jsxs(f,{children:[(e==null?void 0:e.question_type)||"نوع السؤال"," *"]}),t.jsxs(V,{value:i.question_type,onValueChange:s=>o("question_type",s),disabled:!!l,children:[t.jsx(R,{children:t.jsx(z,{placeholder:"Select question type"})}),t.jsx(G,{children:te.map(s=>t.jsx(J,{value:s.value,children:s.label},s.value))})]}),t.jsx(x,{message:c.question_type})]}),t.jsxs("div",{children:[t.jsxs(f,{children:[(e==null?void 0:e.marks)||"الدرجات"," *"]}),t.jsx(S,{type:"number",step:"0.5",min:"0.5",name:"marks",value:i.marks.toString(),onChange:s=>o("marks",parseFloat(s.target.value)||0),placeholder:"Enter marks"}),t.jsx(x,{message:c.marks})]})]}),t.jsxs("div",{children:[t.jsxs(f,{children:[(e==null?void 0:e.question_title)||"عنوان السؤال"," *"]}),t.jsx(S,{name:"title",value:i.title,onChange:s=>K(s,o),placeholder:(e==null?void 0:e.enter_question_title)||"أدخل عنوان السؤال"}),t.jsx(x,{message:c.title})]}),t.jsxs("div",{children:[t.jsx(f,{children:(e==null?void 0:e.description_optional)||"الوصف (اختياري)"}),t.jsx(W,{ssr:!0,output:"html",placeholder:{paragraph:(e==null?void 0:e.add_context_instructions)||"أضف سياق أو تعليمات إضافية...",imageCaption:(e==null?void 0:e.add_context_instructions)||"أضف سياق أو تعليمات إضافية..."},contentMinHeight:150,contentMaxHeight:300,initialContent:i.description,onContentChange:s=>o(u=>({...u,description:s}))}),t.jsx(x,{message:c.description})]}),N(),t.jsxs("div",{className:"flex justify-end gap-3 border-t pt-4",children:[t.jsx(H,{type:"button",variant:"outline",onClick:()=>m(!1),disabled:_||r,children:(e==null?void 0:e.cancel)||"إلغاء"}),t.jsx(b,{loading:_||r,disabled:_||r,children:l?(e==null?void 0:e.update_question)||"تحديث السؤال":(e==null?void 0:e.create_question)||"إنشاء سؤال"})]})]})]})]})};export{Ce as default};
