import{u as U,r as u,b as D,j as e,T as f,db as g,d2 as V,v as C,C as W,dc as R,da as $,e as q}from"./vendor-BBDGfIfP.js";import{L as J}from"./loading-button-BLSSbYXc.js";import{B as o}from"./button-BxbUMaK9.js";import{C as Q}from"./card-XBn4TxoT.js";import{D as S,b as F,c as z,d as B,g as P,e as E}from"./dialog-Ao4xhLhR.js";import X from"./backgup-downloader-w81S_AfH.js";import"./utils-fgVZ67ei.js";import"./index-BSu11NtU.js";const ne=({recentBackups:x})=>{var v,k;const{props:p}=U(),_=(p==null?void 0:p.translate)||{},a=(_==null?void 0:_.settings)||{},s={recent_backups:a.recent_backups||"Recent Backups",view_manage_backups:a.view_manage_backups||"View and manage your recent application backups",delete_backup:a.delete_backup||"Delete Backup",deleting_backup:a.deleting_backup||"Deleting backup...",please_wait:a.please_wait||"Please wait",delete_backup_confirm:a.delete_backup_confirm||'Are you sure you want to delete the backup ":backup_name"?',this_action_will:a.this_action_will||"This action will:",permanently_delete_files:a.permanently_delete_files||"Permanently delete the backup files from storage",remove_backup_record:a.remove_backup_record||"Remove the backup record from the database",cannot_be_undone:a.cannot_be_undone||"Cannot be undone or recovered",backup_details:a.backup_details||"Backup Details:",source_code:a.source_code||"Source Code",database:a.database||"Database",created:a.created||"Created",cancel:a.cancel||"Cancel",deleting:a.deleting||"Deleting...",delete_backup_button:a.delete_backup_button||"Delete Backup",restore_backup:a.restore_backup||"Restore Backup",restoring_backup:a.restoring_backup||"Restoring backup...",please_do_not_close:a.please_do_not_close||"Please do not close this window",restore_backup_confirm:a.restore_backup_confirm||'Are you sure you want to restore the backup ":backup_name"?',this_restore_will:a.this_restore_will||"This restore will:",put_site_maintenance_mode:a.put_site_maintenance_mode||"Put the site in maintenance mode",overwrite_current_files:a.overwrite_current_files||"Overwrite all current application files",replace_entire_database:a.replace_entire_database||"Replace the entire database with backup data",process_take_minutes:a.process_take_minutes||"Process may take several minutes",critical_warning:a.critical_warning||"Critical Warning:",all_current_data_lost:a.all_current_data_lost||"All current data and files will be lost! Make sure you have a recent backup of your current state if needed. This action cannot be undone.",restoring:a.restoring||"Restoring...",confirm_restore:a.confirm_restore||"Confirm Restore",refresh_server:a.refresh_server||"Refresh Server",refresh:a.refresh||"Refresh",restore:a.restore||"Restore",delete:a.delete||"Delete",no_backups_found:a.no_backups_found||"No recent backups found.",create_first_backup:a.create_first_backup||"Create your first backup using the form above",status:a.status||"Status",completed:a.completed||"Completed",important_update_guidelines:a.important_update_guidelines||"Important Update Guidelines",refresh_server_guideline:a.refresh_server_guideline||"Every time refresh server before updating",notes:a.notes||"Notes:"},[l,i]=u.useState(!1),[T,d]=u.useState(!1),[M,m]=u.useState(!1),[r,n]=u.useState(null),h=D({}),A=()=>{h.post(route("system.refresh"))},O=t=>{n(t),d(!0)},I=t=>{n(t),m(!0)},{delete:L,processing:j}=D({}),K=t=>{r&&(i(!0),L(route("system.backup.delete",r.id),{onSuccess:()=>{d(!1),n(null),i(!1)},onError:()=>{i(!1)}}))},G=()=>{r&&(i(!0),q.post(route("system.backup.restore",r.id),{},{onSuccess:()=>{m(!1),n(null),i(!1)},onError:()=>{i(!1)}}))},N=()=>{l||(d(!1),m(!1),n(null))},c=t=>{if(t===0)return"0 Bytes";const w=1024,H=["Bytes","KB","MB","GB"],y=Math.floor(Math.log(t)/Math.log(w));return parseFloat((t/Math.pow(w,y)).toFixed(2))+" "+H[y]},b=t=>new Date(t).toLocaleString();return e.jsxs(e.Fragment,{children:[e.jsx(S,{open:T,onOpenChange:t=>{l||(d(t),t||n(null))},children:e.jsxs(F,{className:"sm:max-w-[500px]",onInteractOutside:t=>{l&&t.preventDefault()},onEscapeKeyDown:t=>{l&&t.preventDefault()},children:[l&&e.jsx("div",{className:"bg-background/80 absolute inset-0 z-10 flex items-center justify-center rounded-lg backdrop-blur-sm",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"border-primary mx-auto mb-4 h-8 w-8 animate-spin rounded-full border-4 border-t-transparent"}),e.jsx("p",{className:"text-sm font-medium",children:s.deleting_backup}),e.jsx("p",{className:"text-muted-foreground mt-1 text-xs",children:s.please_wait})]})}),e.jsxs(z,{children:[e.jsxs(B,{className:"flex items-center gap-2",children:[e.jsx(f,{className:"h-5 w-5 text-red-600"}),s.delete_backup]}),e.jsxs(P,{className:"space-y-4 text-left",children:[e.jsx("p",{children:(v=s.delete_backup_confirm)==null?void 0:v.replace(":backup_name",(r==null?void 0:r.backup_name)||"")}),e.jsxs("div",{className:"rounded-lg border border-red-200 bg-red-50 p-4",children:[e.jsxs("p",{className:"mb-2 font-medium text-red-800",children:["⚠️ ",s.this_action_will]}),e.jsxs("ul",{className:"list-inside list-disc space-y-1 text-sm text-red-700",children:[e.jsx("li",{children:s.permanently_delete_files}),e.jsx("li",{children:s.remove_backup_record}),e.jsx("li",{children:s.cannot_be_undone})]})]}),e.jsx("div",{className:"rounded-lg border border-amber-200 bg-amber-50 p-4",children:e.jsxs("p",{className:"text-sm text-amber-700",children:[e.jsx("strong",{children:s.backup_details}),e.jsx("br",{}),s.source_code,": ",r?c(r.source_code_size):"",e.jsx("br",{}),s.database,": ",r?c(r.database_size):"",e.jsx("br",{}),s.created,": ",r?b(r.created_at):""]})})]})]}),e.jsxs(E,{className:"flex-col gap-2 sm:flex-row",children:[e.jsx(o,{variant:"outline",onClick:N,disabled:l,className:"w-full sm:w-auto",children:s.cancel}),e.jsx("form",{onSubmit:K,children:e.jsx(o,{type:"submit",variant:"destructive",disabled:j,className:"w-full sm:w-auto",children:j?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mr-2 animate-spin",children:"⏳"}),s.deleting]}):e.jsxs(e.Fragment,{children:[e.jsx(f,{className:"mr-2 h-4 w-4"}),s.delete_backup_button]})})})]})]})}),e.jsx(S,{open:M,onOpenChange:t=>{l||(m(t),t||n(null))},children:e.jsxs(F,{className:"sm:max-w-[500px]",onInteractOutside:t=>{l&&t.preventDefault()},onEscapeKeyDown:t=>{l&&t.preventDefault()},children:[l&&e.jsx("div",{className:"bg-background/80 absolute inset-0 z-10 flex items-center justify-center rounded-lg backdrop-blur-sm",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"border-primary mx-auto mb-4 h-8 w-8 animate-spin rounded-full border-4 border-t-transparent"}),e.jsx("p",{className:"text-sm font-medium",children:s.restoring_backup}),e.jsx("p",{className:"text-muted-foreground mt-1 text-xs",children:s.please_do_not_close})]})}),e.jsxs(z,{children:[e.jsxs(B,{className:"flex items-center gap-2",children:[e.jsx(g,{className:"h-5 w-5 text-blue-600"}),s.restore_backup]}),e.jsxs(P,{className:"space-y-4 text-left",children:[e.jsx("p",{children:(k=s.restore_backup_confirm)==null?void 0:k.replace(":backup_name",(r==null?void 0:r.backup_name)||"")}),e.jsxs("div",{className:"rounded-lg border border-orange-200 bg-orange-50 p-4",children:[e.jsx("p",{className:"mb-2 font-medium text-orange-800",children:s.this_restore_will}),e.jsxs("ul",{className:"list-inside list-disc space-y-1 text-sm text-orange-700",children:[e.jsx("li",{children:s.put_site_maintenance_mode}),e.jsx("li",{children:s.overwrite_current_files}),e.jsx("li",{children:s.replace_entire_database}),e.jsx("li",{children:s.process_take_minutes})]})]}),e.jsxs("div",{className:"rounded-lg border border-red-200 bg-red-50 p-4",children:[e.jsxs("p",{className:"mb-1 font-medium text-red-800",children:["⚠️ ",s.critical_warning]}),e.jsx("p",{className:"text-sm text-red-700",children:s.all_current_data_lost})]}),e.jsx("div",{className:"rounded-lg border border-blue-200 bg-blue-50 p-4",children:e.jsxs("p",{className:"text-sm text-blue-700",children:[e.jsx("strong",{children:s.backup_details}),e.jsx("br",{}),s.created,": ",r?b(r.created_at):"",e.jsx("br",{}),s.source_code,": ",r?c(r.source_code_size):"",e.jsx("br",{}),s.database,": ",r?c(r.database_size):"",e.jsx("br",{}),s.status,": ",(r==null?void 0:r.status)||""]})})]})]}),e.jsxs(E,{className:"flex-col gap-2 sm:flex-row",children:[e.jsx(o,{variant:"outline",onClick:N,disabled:l,className:"w-full sm:w-auto",children:s.cancel}),e.jsx(o,{variant:"destructive",onClick:G,disabled:l,className:"w-full sm:w-auto",children:l?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mr-2 animate-spin",children:"⏳"}),s.restoring]}):e.jsxs(e.Fragment,{children:[e.jsx(g,{className:"mr-2 h-4 w-4"}),s.confirm_restore]})})]})]})}),e.jsxs(Q,{className:"p-4 sm:p-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:s.recent_backups}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm",children:s.view_manage_backups})]}),e.jsx("div",{className:"dark:bg-secondary dark:border-border mb-6 rounded-lg border border-amber-200 bg-amber-50 p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(V,{className:"h-5 w-5 text-amber-600"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-amber-800",children:s.important_update_guidelines}),e.jsx("div",{className:"mt-2 text-sm text-amber-700",children:e.jsx("ul",{className:"list-inside list-disc space-y-1",children:e.jsxs("li",{children:[e.jsxs("strong",{children:[s.refresh_server,":"]})," ",s.refresh_server_guideline]})})})]})]})}),x&&x.length>0?e.jsx("div",{className:"space-y-4",children:x.map(t=>e.jsx("div",{className:"rounded-lg border p-4 transition-colors hover:bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"mb-2 flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(C,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"font-medium",children:t.backup_name})]}),e.jsx("span",{className:`rounded-full px-2 py-1 text-xs ${t.status==="completed"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:t.status})]}),e.jsxs("div",{className:"text-muted-foreground grid grid-cols-1 gap-4 text-sm md:grid-cols-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{className:"h-4 w-4"}),e.jsx("span",{children:b(t.created_at)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{className:"h-4 w-4"}),e.jsxs("span",{children:[s.source_code,": ",c(t.source_code_size)]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{className:"h-4 w-4"}),e.jsxs("span",{children:[s.database,": ",c(t.database_size)]})]})]}),t.notes&&e.jsxs("div",{className:"mt-2 text-sm text-gray-500",children:[e.jsx("strong",{children:s.notes})," ",t.notes]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{type:"button",variant:"ghost",onClick:A,loading:h.processing,disabled:h.processing,children:e.jsxs("div",{className:"text-secondary-foreground flex items-center gap-2",children:[e.jsx($,{className:"h-4 w-4"}),e.jsx("span",{children:s.refresh})]})}),e.jsxs(o,{variant:"ghost",onClick:()=>I(t),className:"flex items-center gap-1 rounded-md px-3 py-2 text-blue-600 transition-colors hover:bg-blue-50 hover:text-blue-800",title:s.restore_backup,children:[e.jsx(g,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:s.restore})]}),e.jsx(X,{backup:t}),e.jsxs(o,{variant:"ghost",onClick:()=>O(t),className:"flex items-center gap-1 rounded-md px-3 py-2 text-red-600 transition-colors hover:bg-red-50 hover:text-red-800",title:s.delete_backup,children:[e.jsx(f,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:s.delete})]})]})]})},t.id))}):e.jsxs("div",{className:"py-8 text-center text-gray-500",children:[e.jsx(C,{className:"mx-auto mb-3 h-12 w-12 opacity-50"}),e.jsx("p",{children:s.no_backups_found}),e.jsx("p",{className:"text-sm",children:s.create_first_backup})]})]})]})};export{ne as default};
