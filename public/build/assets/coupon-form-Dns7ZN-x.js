import{u as B,r as u,b as M,j as e,ca as U}from"./vendor-BBDGfIfP.js";import{I as n}from"./input-error-DzlB5Qkt.js";import{L as V}from"./loading-button-BLSSbYXc.js";import{B as p}from"./button-BxbUMaK9.js";import{D as H,a as O,b as R,c as q,d as P,e as $,f as z}from"./dialog-Ao4xhLhR.js";import{I as o}from"./input-Dldj9DiJ.js";import{L as d}from"./label-DUVUvbLf.js";import{S as y,a as C,b as S,c as b,d as _}from"./select-CMFY0w3t.js";import{S as A}from"./switch-DRIloLVZ.js";import{o as j}from"./inertia-SZXqLvQm.js";import"./utils-fgVZ67ei.js";import"./index-BSu11NtU.js";const ie=({title:D,handler:F,coupon:s,exams:N})=>{var f;const{props:I}=B(),{translate:E}=I,{dashboard:t,button:x}=E,[c,h]=u.useState(!1),m=a=>a?a.replace(" ","T").substring(0,16):"",{data:r,setData:i,post:L,put:w,reset:v,processing:g,errors:l}=M({exam_id:(s==null?void 0:s.exam_id)||"",code:(s==null?void 0:s.code)||"",discount_type:(s==null?void 0:s.discount_type)||"percentage",discount:(s==null?void 0:s.discount)||0,valid_from:m(s==null?void 0:s.valid_from),valid_to:m(s==null?void 0:s.valid_to),is_active:(s==null?void 0:s.is_active)??!0}),T=a=>{a.preventDefault(),s?w(route("exam-coupons.update",s.id),{preserveScroll:!0,onSuccess:()=>{h(!1)}}):L(route("exam-coupons.store"),{preserveScroll:!0,onSuccess:()=>{v(),h(!1)}})},k=()=>{const a=Math.random().toString(36).substring(2,10).toUpperCase();i("code",a)};return u.useEffect(()=>{c&&s?i({exam_id:s.exam_id||"",code:s.code||"",discount_type:s.discount_type||"percentage",discount:s.discount||0,valid_from:m(s.valid_from),valid_to:m(s.valid_to),is_active:s.is_active??!0}):c||v()},[c,s]),e.jsxs(H,{open:c,onOpenChange:h,children:[e.jsx(O,{asChild:!0,children:F}),e.jsxs(R,{className:"max-w-2xl",children:[e.jsx(q,{children:e.jsx(P,{children:D})}),e.jsxs("form",{onSubmit:T,children:[e.jsx("div",{className:"space-y-4 py-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsxs(d,{htmlFor:"code",children:[t.coupon_code||"كود القسيمة"," *"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(o,{id:"code",name:"code",value:r.code,onChange:a=>i("code",a.target.value.toUpperCase()),placeholder:t.coupon_code_placeholder||"SUMMER2024"}),e.jsx(p,{type:"button",variant:"outline",onClick:k,children:e.jsx(U,{className:"h-4 w-4"})})]}),e.jsx(n,{message:l.code})]}),e.jsxs("div",{children:[e.jsxs(d,{htmlFor:"discount_type",children:[t.discount_type||"نوع الخصم"," *"]}),e.jsxs(y,{name:"discount_type",value:r.discount_type,onValueChange:a=>i("discount_type",a),children:[e.jsx(C,{children:e.jsx(S,{placeholder:t.select_type||"اختر النوع"})}),e.jsxs(b,{children:[e.jsx(_,{value:"percentage",children:t.discount_type_percentage||"نسبة (%)"}),e.jsx(_,{value:"fixed",children:t.discount_type_fixed||"مبلغ ثابت ($)"})]})]}),e.jsx(n,{message:l.discount_type})]}),e.jsxs("div",{children:[e.jsxs(d,{htmlFor:"discount",children:[t.discount_value||"قيمة الخصم"," *"]}),e.jsx(o,{id:"discount",name:"discount",type:"number",value:r.discount,onChange:a=>j(a,i),min:"0",step:"0.01",required:!0}),e.jsx(n,{message:l.discount})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(d,{htmlFor:"exam_id",children:t.select_exam||"اختر اختبار"}),e.jsxs(y,{name:"exam_id",value:(f=r.exam_id)==null?void 0:f.toString(),onValueChange:a=>i("exam_id",a?parseInt(a):""),children:[e.jsx(C,{children:e.jsx(S,{placeholder:t.all_exams_global_coupon||"جميع الاختبارات (قسيمة عامة)"})}),e.jsx(b,{children:N.map(a=>e.jsx(_,{value:a.id.toString(),children:a.title},a.id))})]}),e.jsx(n,{message:l.exam_id})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"valid_from",children:t.valid_from||"صالح من"}),e.jsx(o,{id:"valid_from",name:"valid_from",type:"datetime-local",value:r.valid_from,onChange:a=>j(a,i)}),e.jsx(n,{message:l.valid_from})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"valid_to",children:t.valid_to||"صالح إلى"}),e.jsx(o,{id:"valid_to",name:"valid_to",type:"datetime-local",value:r.valid_to,onChange:a=>j(a,i)}),e.jsx(n,{message:l.valid_to})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(d,{htmlFor:"is_active",children:t.active||"نشط"}),e.jsx(A,{id:"is_active",checked:r.is_active,onCheckedChange:a=>i("is_active",a)})]})]})}),e.jsxs($,{className:"gap-2",children:[e.jsx(z,{asChild:!0,children:e.jsx(p,{type:"button",variant:"outline",children:x.cancel||"إلغاء"})}),e.jsx(V,{loading:g,disabled:g,children:s?x.update||"تحديث":x.create||"إنشاء"})]})]})]})]})};export{ie as default};
