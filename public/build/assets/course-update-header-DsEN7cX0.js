import{r as E,u as I,b as O,j as e,L as _,e as f}from"./vendor-CVklK8n9.js";import{I as v}from"./input-error-ucpTTRPI.js";import{L as T}from"./loading-button-ChsiQlc4.js";import{B as n}from"./button-DQg8E2h7.js";import{D as b,a as y,b as C,c as M,d as P}from"./dialog-DvjXkL6V.js";import{L as N}from"./label-BlcvhkRY.js";import{S as R,a as V,b as A,c as F,d as U}from"./select-DAGKYYje.js";import{c as G}from"./utils-fgVZ67ei.js";import{k as J}from"./richtor-DcvB5uLy.js";import"./index-BSu11NtU.js";const ae=()=>{const[S,p]=E.useState(!1),{props:i}=I(),{translate:k}=i,{dashboard:s,button:r,input:l,common:h}=k,m=i.auth.user,{course:t,watchHistory:o,approvalStatus:w}=i,D=i.statuses.filter(a=>a!==t.status),{approve_able:d,validation_messages:z,counts:c}=w;s.approved,s.rejected,s.pending;const{data:x,put:L,setData:j,processing:H,errors:g,reset:q}=O({status:"",feedback:""}),B=a=>{a.preventDefault(),L(route("course.status",{id:t.id}),{onSuccess:()=>{q(),p(!1)}})};return e.jsxs("div",{className:"flex flex-wrap items-center gap-4 md:gap-6",children:[e.jsx(n,{children:e.jsx(_,{href:route("course.details",{slug:t.slug,id:t.id}),children:r.course_preview})}),o?e.jsx(n,{children:e.jsx(_,{href:route("course.player",{type:o.current_watching_type,watch_history:o.id,lesson_id:o.current_watching_id}),children:r.course_player})}):d?e.jsx(n,{onClick:()=>f.post(route("player.init.watch-history"),{course_id:t.id}),children:r.course_player}):e.jsx(n,{disabled:!0,children:r.course_player}),e.jsx(n,{className:G("capitalize",t.status==="approved"?"bg-green-500":t.status==="rejected"?"bg-red-500":"bg-gray-500"),disabled:!0,children:t.status==="approved"?s.approved:t.status==="rejected"?s.rejected:t.status==="pending"?s.pending:t.status}),m.role==="instructor"&&t.status!=="approved"&&t.status!=="pending"&&(d?e.jsx(n,{onClick:()=>f.put(route("course.status",{id:t.id}),{status:"pending"}),children:r.submit_for_approval}):e.jsxs(b,{open:S,onOpenChange:p,children:[e.jsx(y,{children:e.jsx(n,{children:r.submit_for_approval})}),e.jsxs(C,{children:[e.jsx(M,{children:e.jsx(P,{children:s.course_approval_status})}),d?e.jsx("div",{className:"text-green-600",children:s.course_ready_approval}):e.jsxs("div",{className:"text-red-600",children:[e.jsx("h3",{children:s.course_needs_attention}),e.jsx("ul",{className:"list-disc pl-5",children:z.map((a,u)=>e.jsx("li",{children:a},u))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium",children:s.course_content_summary}),e.jsxs("p",{children:[s.sections,": ",c.sections_count]}),e.jsxs("p",{children:[s.lessons,": ",c.lessons_count]}),e.jsxs("p",{children:[s.quizzes,": ",c.quizzes_count]}),e.jsxs("p",{className:"font-medium",children:[s.total_content_items,": ",c.total_content_count]})]})]})]})),m.role==="admin"&&e.jsxs(b,{children:[e.jsx(y,{asChild:!0,children:e.jsx(n,{className:"capitalize",children:r.approval_status})}),e.jsx(C,{children:e.jsxs("form",{onSubmit:B,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(N,{children:h.status}),e.jsxs(R,{required:!0,value:x.status,onValueChange:a=>j("status",a),children:[e.jsx(V,{children:e.jsx(A,{placeholder:h.select_the_approval_status})}),e.jsx(F,{children:D.map(a=>e.jsx(U,{value:a,children:a},a))})]}),e.jsx(v,{message:g.status})]}),e.jsxs("div",{className:"pb-6",children:[e.jsxs(N,{children:[l.feedback," ","(Optional)"]}),e.jsx(J,{ssr:!0,output:"html",placeholder:{paragraph:l.description_placeholder,imageCaption:l.image_url_placeholder},contentMinHeight:256,contentMaxHeight:640,initialContent:x.feedback,onContentChange:a=>j(u=>({...u,feedback:a}))}),e.jsx(v,{message:g.feedback})]}),e.jsx(T,{loading:H,className:"w-full",children:r.submit})]})})]})]})};export{ae as default};
