import{r as E,u as I,b as O,j as e,L as f,e as v}from"./vendor-BBDGfIfP.js";import{I as b}from"./input-error-DzlB5Qkt.js";import{L as M}from"./loading-button-BLSSbYXc.js";import{B as i}from"./button-BxbUMaK9.js";import{D as y,a as C,b as N,c as V,d as F}from"./dialog-Ao4xhLhR.js";import{L as S}from"./label-DUVUvbLf.js";import{S as P,a as R,b as U,c as A,d as G}from"./select-CMFY0w3t.js";import{c as J}from"./utils-fgVZ67ei.js";import{k as K}from"./richtor-QjVY_KZS.js";import"./index-BSu11NtU.js";const ae=()=>{const[k,h]=E.useState(!1),{props:c}=I(),{translate:w}=c,{dashboard:s,button:a,input:d,common:n}=w,m=c.auth.user,{course:r,watchHistory:l,approvalStatus:D}=c,z=c.statuses.filter(t=>t!==r.status),{approve_able:u,validation_messages:L,counts:o}=D,x={approved:(s==null?void 0:s.approved)||"موافق عليه",rejected:(s==null?void 0:s.rejected)||"مرفوض",pending:(s==null?void 0:s.pending)||"قيد الانتظار",draft:(s==null?void 0:s.draft)||(n==null?void 0:n.draft)||"مسودة"},{data:j,put:H,setData:g,processing:T,errors:_,reset:q}=O({status:"",feedback:""}),B=t=>{t.preventDefault(),H(route("course.status",{id:r.id}),{onSuccess:()=>{q(),h(!1)}})};return e.jsxs("div",{className:"flex flex-wrap items-center gap-4 md:gap-6",children:[e.jsx(i,{children:e.jsx(f,{href:route("course.details",{slug:r.slug,id:r.id}),children:a.course_preview})}),l?e.jsx(i,{children:e.jsx(f,{href:route("course.player",{type:l.current_watching_type,watch_history:l.id,lesson_id:l.current_watching_id}),children:a.course_player})}):u?e.jsx(i,{onClick:()=>v.post(route("player.init.watch-history"),{course_id:r.id}),children:a.course_player}):e.jsx(i,{disabled:!0,children:a.course_player}),e.jsx(i,{className:J("capitalize",r.status==="approved"?"bg-green-500":r.status==="rejected"?"bg-red-500":"bg-gray-500"),disabled:!0,children:x[r.status]||r.status}),m.role==="instructor"&&r.status!=="approved"&&r.status!=="pending"&&(u?e.jsx(i,{onClick:()=>v.put(route("course.status",{id:r.id}),{status:"pending"}),children:a.submit_for_approval}):e.jsxs(y,{open:k,onOpenChange:h,children:[e.jsx(C,{children:e.jsx(i,{children:a.submit_for_approval})}),e.jsxs(N,{children:[e.jsx(V,{children:e.jsx(F,{children:s.course_approval_status})}),u?e.jsx("div",{className:"text-green-600",children:s.course_ready_approval}):e.jsxs("div",{className:"text-red-600",children:[e.jsx("h3",{children:s.course_needs_attention}),e.jsx("ul",{className:"list-disc pl-5",children:L.map((t,p)=>e.jsx("li",{children:t},p))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium",children:s.course_content_summary}),e.jsxs("p",{children:[s.sections,": ",o.sections_count]}),e.jsxs("p",{children:[s.lessons,": ",o.lessons_count]}),e.jsxs("p",{children:[s.quizzes,": ",o.quizzes_count]}),e.jsxs("p",{className:"font-medium",children:[s.total_content_items,": ",o.total_content_count]})]})]})]})),m.role==="admin"&&e.jsxs(y,{children:[e.jsx(C,{asChild:!0,children:e.jsx(i,{className:"capitalize",children:a.approval_status})}),e.jsx(N,{children:e.jsxs("form",{onSubmit:B,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(S,{children:n.status}),e.jsxs(P,{required:!0,value:j.status,onValueChange:t=>g("status",t),children:[e.jsx(R,{children:e.jsx(U,{placeholder:n.select_the_approval_status})}),e.jsx(A,{children:z.map(t=>e.jsx(G,{value:t,children:x[t]||t},t))})]}),e.jsx(b,{message:_.status})]}),e.jsxs("div",{className:"pb-6",children:[e.jsxs(S,{children:[d.feedback," ","(Optional)"]}),e.jsx(K,{ssr:!0,output:"html",placeholder:{paragraph:d.description_placeholder,imageCaption:d.image_url_placeholder},contentMinHeight:256,contentMaxHeight:640,initialContent:j.feedback,onContentChange:t=>g(p=>({...p,feedback:t}))}),e.jsx(b,{message:_.feedback})]}),e.jsx(M,{loading:T,className:"w-full",children:a.submit})]})})]})]})};export{ae as default};
