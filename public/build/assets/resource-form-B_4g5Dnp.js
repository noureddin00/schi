import{r as x,u as L,b as R,j as e}from"./vendor-CSmzIpnM.js";import{C as q}from"./chunked-uploader-input-Yn25Jrwl.js";import{I as j}from"./input-error-DFZPMsrM.js";import{L as D}from"./loading-button-CjOdg6Ro.js";import{I as v}from"./input-CXffHHHp.js";import{L as i}from"./label-aM7LSFRq.js";import{S as T,a as V,b as N,c as w,d as z}from"./select-OeQ7gBvr.js";import{g as A}from"./file-metadata-CAFSN-Sn.js";import{o as g}from"./inertia-SZXqLvQm.js";import"./button-CPCtH35G.js";import"./index-BSu11NtU.js";import"./utils-fgVZ67ei.js";import"./index-C3-Y1HVF.js";const O=({lesson:n,resource:l,isSubmit:u,setIsSubmit:s,setIsOpen:d})=>{const[y,p]=x.useState(!1),{props:_}=L(),{translate:F}=_,{input:o,button:b}=F,{data:t,setData:a,post:C,put:S,reset:c,processing:m,errors:f,clearErrors:E}=R({title:l?l.title:"",type:l?l.type:"document",resource:l?l.resource:"",resource_url:null,section_lesson_id:n.id}),U=async r=>{if(r.preventDefault(),t.type==="link"){h();return}s(!0)},h=()=>{E(),l?S(route("resources.update",l.id),{preserveScroll:!0,onSuccess:()=>{c(),s(!1),d(!0)}}):C(route("resources.store"),{preserveScroll:!0,onSuccess:()=>{c(),s(!1),d(!0)}})};x.useEffect(()=>{t.resource_url&&y&&(h(),c("resource_url"),p(!1))},[t.resource_url]);const k=[{label:"Document",value:"document"},{label:"Image File",value:"image"},{label:"Video File",value:"video"},{label:"Zip/Archive",value:"zip"},{label:"External Link",value:"link"}];return e.jsxs("form",{onSubmit:U,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:o.title}),e.jsx(v,{required:!0,name:"title",value:t.title,placeholder:o.title,onChange:r=>g(r,a)}),e.jsx(j,{message:f.title})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Resource Type"}),e.jsxs(T,{required:!0,name:"type",value:t.type,onValueChange:r=>a("type",r),children:[e.jsx(V,{className:"w-full",children:e.jsx(N,{placeholder:o.select})}),e.jsx(w,{children:k.map(r=>e.jsx(z,{value:r.value,children:r.label},r.value))})]})]}),t.type==="link"?e.jsxs("div",{children:[e.jsx(i,{children:"Resource"}),e.jsx(v,{required:!0,type:"url",name:"resource",value:t.resource,placeholder:o.url,onChange:r=>g(r,a)}),e.jsx(j,{message:f.resource})]}):e.jsxs("div",{children:[e.jsx(i,{children:"Resource"}),e.jsx(q,{isSubmit:u,courseId:n.course_id,sectionId:n.course_section_id,filetype:t.type,delayUpload:!0,onFileSelected:r=>{A(r).then(I=>{a("title",I.name)})},onFileUploaded:r=>{p(!0),a("resource_url",r.file_url)},onError:r=>{s(!1)},onCancelUpload:()=>{s(!1)}})]}),e.jsx(D,{loading:m||u,disabled:m||u,children:l?"Update":b.submit})]})};export{O as default};
